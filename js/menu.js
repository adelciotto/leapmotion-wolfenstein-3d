Wolf.Menu=function(){function e(e){Wolf.Sound.startSound(null,null,1,Wolf.CHAN_AUTO,e,1,Wolf.ATTN_NORM,0)}function n(n){e("lsfx/005.wav"),$("#menu div.menu.active li").removeClass("active"),n.addClass("active"),$("#menu div.menu.active").hasClass("skill")&&$("#menu div.menu.active div.face").removeClass().addClass("face "+n.data("skill"))}function a(){$(document).on("keydown",function(a){if($("#menu").is(":visible")&&h){var i=C;switch(a.keyCode){case 38:C--,k=null;break;case 40:C++,k=null;break;case 13:k?k.trigger("click"):$("#menu div.menu.active li").eq(C).trigger("click");break;case 27:var s=$("#menu div.menu.active").data("backmenu");return void(s&&(e("lsfx/039.wav"),t(s)))}if(i!=C){var o=$("#menu div.menu.active li:not(.hidden)");0>C&&(C+=o.length),C%=o.length,n(o.eq(C))}}}),$("#menu li").mouseover(function(){h&&(k=$(this),n($(this)))}),$("#menu li").on("click",function(n){if(h){e("lsfx/032.wav");var a=$(this),s=a.data("submenu");if(s&&(t(s),n.stopPropagation()),a.hasClass("sfxon")&&($("div.light",a).addClass("on"),$("#menu li.sfxoff div.light").removeClass("on"),Wolf.Sound.toggleSound(!0)),a.hasClass("sfxoff")&&($("div.light",a).addClass("on"),$("#menu li.sfxon div.light").removeClass("on"),Wolf.Sound.toggleSound(!1)),a.hasClass("musicon")&&($("div.light",a).addClass("on"),$("#menu li.musicoff div.light").removeClass("on"),Wolf.Sound.toggleMusic(!0)),a.hasClass("musicoff")&&($("div.light",a).addClass("on"),$("#menu li.musicon div.light").removeClass("on"),Wolf.Sound.toggleMusic(!1)),a.hasClass("mouseenabled")){var o=Wolf.Game.isMouseEnabled();$("div.light",a).toggleClass("on",!o),Wolf.Game.enableMouse(!o)}a.hasClass("customizekeys")&&(i(a),n.stopPropagation())}}),$("#menu div.menu.episodes li").on("click",function(e){if(h){var n=$(this).data("episode");Wolf.Game.isPlaying()?l("confirm-newgame",!0,function(e){e?(m=n,t("skill")):t("main")}):(m=n,t("skill"))}}),$("#menu div.menu.skill li").on("click",function(e){h&&(v=$(this).data("skill"))}),$("#menu div.menu.main li.resumegame").on("click",function(e){h&&Wolf.Game.isPlaying()&&(u(),Wolf.Game.resume())}),$("#menu div.menu.main li.readthis").on("click",function(e){h&&(h=!1,$("#menu").fadeOut(null,function(){d("help",11,function(){$("#menu").fadeIn()})}),e.stopPropagation())}),$("#menu div.menu.levels li").on("click",function(e){if(h){var n,a;u(),n=$(this).data("level"),a=Wolf.Game.startGame(Wolf[v]),Wolf.Game.startLevel(a,m,n)}})}function i(e){function n(n){0>n&&(n+=4),n%=4;var a=$("span.active",e);a[0]&&s(a.data("action"),a.data("keyIndex"),!1);var i=$("span.k"+(n+1),e);s(i.data("action"),i.data("keyIndex"),!0),d=n}function a(n){m=!0;var a=$("span.k"+(n+1),e),i=!1;s(a.data("action"),"QUESTION",!0),u&&clearInterval(u),u=setInterval(function(){s(a.data("action"),(i=!i)?"BLANK":"QUESTION",!0)},500)}function i(n,a){var i=$("span.k"+(n+1),e);s(i.data("action"),a,!0),Wolf.Game.bindControl(i.data("action"),[a])}function l(){$(document).off("keydown",t),o(),h=!0}function t(e){var s;if(m){for(s=2;s<p.length;s++)if(Wolf.Keys[p[s]]==e.keyCode){i(d,p[s]),m=!1,clearInterval(u),u=0;break}}else switch(e.keyCode){case 39:n(d+1);break;case 37:n(d-1);break;case 13:a(d);break;case 27:case 38:case 40:l()}}h=!1;var u,d=0,m=!1;$(document).on("keydown",t),n(d)}function s(e,n,a){var i=$("#menu div.menu.customize"),s=a?-256:0,o=32*-b[n];$("span."+e,i).css("backgroundPosition",s+"px "+o+"px").data("keyIndex",n).toggleClass("active",!!a)}function o(){var e,n=Wolf.Game.getControls(),a=["run","use","attack","strafe","left","right","up","down"];for(e=0;e<a.length;e++)s(a[e],n[a[e]][0])}function l(n,a,i){function s(a){e("lsfx/039.wav"),$(document).off("keydown",o),$("#menu .message."+n).hide(),c&&(clearInterval(c),c=0),h=!0,i&&i(a)}function o(e){switch(e.keyCode){case 27:case 78:s(!1);break;case 89:s(!0)}}var l,t=!1;f=n,h=!1,c&&(clearInterval(c),c=0),$("#menu .message."+n).show(),l=$("#menu .message."+n+" div.box"),l.removeClass("blink"),a&&setInterval(function(){t=!t,t?l.addClass("blink"):l.removeClass("blink")},200),$(document).on("keydown",o)}function t(e){var n,i,s;g||(a(),g=!0),Wolf.Sound.startMusic("music/WONDERIN.ogg"),e=e||"main","main"==e&&(Wolf.Game.isPlaying()?$("#menu div.menu.main li.resumegame").removeClass("hidden").show():$("#menu div.menu.main li.resumegame").addClass("hidden").hide()),"customize"==e&&o(),"episodes"==e&&($("#menu div.menu.episodes li").removeClass("hidden").show(),Wolf.Episodes[0].enabled||$("#menu div.menu.episodes li.episode-0").addClass("hidden").hide(),Wolf.Episodes[1].enabled||$("#menu div.menu.episodes li.episode-1").addClass("hidden").hide(),Wolf.Episodes[2].enabled||$("#menu div.menu.episodes li.episode-2").addClass("hidden").hide()),"sound"==e&&(n=Wolf.Sound.isMusicEnabled(),i=Wolf.Sound.isSoundEnabled(),$("#menu li.sfxoff div.light").toggleClass("on",!i),$("#menu li.sfxon div.light").toggleClass("on",i),$("#menu li.musicoff div.light").toggleClass("on",!n),$("#menu li.musicon div.light").toggleClass("on",n)),"control"==e&&(s=Wolf.Game.isMouseEnabled(),$("#menu li.mouseenabled div.light").toggleClass("on",s)),$("#menu").data("menu")&&$("#menu").removeClass($("#menu").data("menu")),$("#menu div.menu").removeClass("active").hide(),$("#menu li").removeClass("active"),$("#menu").data("menu",e).addClass(e).show(),$("#menu div.menu."+e).addClass("active").show(),$("#menu div.menu."+e+" ul li").first().addClass("active"),$("#menu").focus(),C=0,k=null,h=!0}function u(){$("#menu").hide(),h=!1}function d(e,n,a){function i(a){t+=a,0>t&&(t+=n),t%=n,l.css({backgroundImage:"url(art/text-screens/"+e+"-"+(t+1)+".png)"});var i=(t+1)%n,s=new Image;s.src="art/text-screens/"+e+"-"+(i+1)+".png"}function s(){$(document).off("keydown",o),l.fadeOut(null,a),h=!0}function o(e){switch(e.keyCode){case 39:i(1);break;case 37:i(-1);break;case 27:s()}}var l=$("#text-screen"),t=0;h=!1,i(0),l.fadeIn(null,function(){$(document).on("keydown",o)})}var m,c,f,v,r,g=!1,h=!1,C=0,k=null,b={},p=["BLANK","QUESTION","SHIFT","SPACE","CTRL","LEFT","RIGHT","UP","DOWN","ENTER","DEL","PGUP","PGDN","INS","SLASH","HOME","COMMA","PERIOD","PLUS","MINUS","0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"];for(r=0;r<p.length;r++)""!==p[r]&&(b[p[r]]=r);return{show:t,hide:u,showText:d}}();