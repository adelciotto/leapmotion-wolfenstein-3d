Wolf.Actors=function(){function t(t){if(t.state.numGuards>Wolf.MAX_GUARDS)return null;var e={x:0,y:0,angle:0,type:0,health:0,max_health:0,speed:0,ticcount:0,temp2:0,distance:0,tile:{x:0,y:0},areanumber:0,waitfordoorx:0,waitfordoory:0,flags:0,state:0,dir:0,sprite:0};return t.state.guards[t.state.numGuards++]=e,e}function e(t,e,s){var o;if(t.ticcount)for(t.ticcount-=s;t.ticcount<=0;){if(o=Wolf.objstate[t.type][t.state].action,o&&(o(t,e,s),t.state==Wolf.st_remove))return!1;if(t.state=Wolf.objstate[t.type][t.state].next_state,t.state==Wolf.st_remove)return!1;if(!Wolf.objstate[t.type][t.state].timeout){t.ticcount=0;break}t.ticcount+=Wolf.objstate[t.type][t.state].timeout}return o=Wolf.objstate[t.type][t.state].think,o&&(o(t,e,s),t.state==Wolf.st_remove)?!1:!0}function s(t,e){t.state=e,e==Wolf.st_remove?t.ticcount=0:t.ticcount=Wolf.objstate[t.type][t.state].timeout}function o(t,s){var o,a,n,l=t.level,f=t.player,r=[];for(o=0;o<l.state.numGuards;++o)n=l.state.guards[o],e(n,t,s)?(Wolf.Sprites.setPos(l,n.sprite,n.x,n.y,n.angle),a=Wolf.objstate[n.type][n.state].texture,Wolf.objstate[n.type][n.state].rotate&&(a+=n.type==Wolf.en_rocket||n.type==Wolf.en_hrocket?c[Wolf.Math.get8dir(Wolf.Angle.distCW(Wolf.FINE2RAD(f.angle),Wolf.FINE2RAD(n.angle)))]:d[Wolf.Math.get8dir(Wolf.Angle.distCW(Wolf.FINE2RAD(f.angle),Wolf.FINE2RAD(n.angle)))]),Wolf.Sprites.setTex(l,n.sprite,0,a)):(Wolf.Sprites.remove(l,n.sprite),l.state.guards[o]=null);for(o=0;o<l.state.numGuards;++o)l.state.guards[o]&&r.push(l.state.guards[o]);l.state.guards=r,l.state.numGuards=r.length}function a(t){t.state.guards=[],t.state.numGuards=0}function n(e,s,o,a,n,l){var f=t(e);return f?(f.x=Wolf.TILE2POS(a),f.y=Wolf.TILE2POS(n),f.tile.x=a,f.tile.y=n,f.angle=Wolf.Math.dir4angle[l],f.dir=Wolf.Math.dir4to8[l],f.areanumber=e.areas[a][n],f.areanumber<0&&(f.areanumber=0),f.type=o,f.health=Wolf.starthitpoints[s][o],f.sprite=Wolf.Sprites.getNewSprite(e),f):null}function l(t,e,s,o,a){var l=n(t,e,s,o,a,Wolf.Math.dir4_nodir);l&&(l.state=Wolf.st_dead,l.speed=0,l.health=0,l.ticcount=Wolf.objstate[s][Wolf.st_dead].timeout?Wolf.Random.rnd()%Wolf.objstate[s][Wolf.st_dead].timeout+1:0)}function f(t,e,s,o,a,l){var f=n(t,e,s,o,a,l);f&&(f.state=Wolf.st_path1,f.speed=s==Wolf.en_dog?Wolf.SPDDOG:Wolf.SPDPATROL,f.distance=Wolf.TILEGLOBAL,f.ticcount=Wolf.objstate[s][Wolf.st_path1].timeout?Wolf.Random.rnd()%Wolf.objstate[s][Wolf.st_path1].timeout+1:0,f.flags|=Wolf.FL_SHOOTABLE,t.state.totalMonsters++)}function r(t,e,s,o,a,l){var f=n(t,e,s,o,a,l);f&&(f.state=Wolf.st_stand,f.speed=Wolf.SPDPATROL,f.ticcount=Wolf.objstate[s][Wolf.st_stand].timeout?Wolf.Random.rnd()%Wolf.objstate[s][Wolf.st_stand].timeout+1:0,f.flags|=Wolf.FL_SHOOTABLE,t.tileMap[o][a]&Wolf.AMBUSH_TILE&&(f.flags|=Wolf.FL_AMBUSH),t.state.totalMonsters++)}function _(t,e,s,o,a){var l,f;switch(s){case Wolf.en_boss:case Wolf.en_schabbs:case Wolf.en_fat:case Wolf.en_hitler:f=Wolf.Math.dir4_south;break;case Wolf.en_fake:case Wolf.en_gretel:case Wolf.en_gift:f=Wolf.Math.dir4_north;break;case Wolf.en_trans:case Wolf.en_uber:case Wolf.en_will:case Wolf.en_death:case Wolf.en_angel:case Wolf.en_spectre:f=Wolf.Math.dir4_nodir;break;default:f=Wolf.Math.dir4_nodir}l=n(t,e,s,o,a,f),l&&(l.state=s==Wolf.en_spectre?Wolf.st_path1:Wolf.st_stand,l.speed=Wolf.SPDPATROL,l.health=Wolf.starthitpoints[e][s],l.ticcount=Wolf.objstate[s][Wolf.st_stand].timeout?Wolf.Random.rnd()%Wolf.objstate[s][Wolf.st_stand].timeout+1:0,l.flags|=Wolf.FL_SHOOTABLE|Wolf.FL_AMBUSH,t.state.totalMonsters++)}function i(t,e,s,o,a){var l=n(t,e,s,o,a,Wolf.Math.dir4_nodir);l&&(l.state=Wolf.st_chase1,l.speed=3*Wolf.SPDPATROL,l.health=Wolf.starthitpoints[e][s],l.ticcount=Wolf.objstate[s][Wolf.st_chase1].timeout?Wolf.Random.rnd()%Wolf.objstate[s][Wolf.st_chase1].timeout+1:0,l.flags|=Wolf.FL_AMBUSH,t.state.totalMonsters++)}function W(t,e,s){var o=Wolf.POS2TILE(t.position.x),a=Wolf.POS2TILE(t.position.y),l=n(e,s,Wolf.en_bj,o,a+1,Wolf.Math.dir4_north);l&&(l.x=t.position.x,l.y=t.position.y,l.state=Wolf.st_path1,l.speed=Wolf.BJRUNSPEED,l.flags=Wolf.FL_NONMARK,l.temp2=6,l.ticcount=1)}Wolf.setConsts({SPDPATROL:512,SPDDOG:1500,FL_SHOOTABLE:1,FL_BONUS:2,FL_NEVERMARK:4,FL_VISABLE:8,FL_ATTACKMODE:16,FL_FIRSTATTACK:32,FL_AMBUSH:64,FL_NONMARK:128,MAX_GUARDS:255,NUMENEMIES:31,NUMSTATES:34,MINACTORDIST:65536}),Wolf.setConsts({en_guard:0,en_officer:1,en_ss:2,en_dog:3,en_boss:4,en_schabbs:5,en_fake:6,en_mecha:7,en_hitler:8,en_mutant:9,en_blinky:10,en_clyde:11,en_pinky:12,en_inky:13,en_gretel:14,en_gift:15,en_fat:16,en_needle:17,en_fire:18,en_rocket:19,en_smoke:20,en_bj:21,en_spark:22,en_hrocket:23,en_hsmoke:24,en_spectre:25,en_angel:26,en_trans:27,en_uber:28,en_will:29,en_death:30}),Wolf.setConsts({st_stand:0,st_path1:1,st_path1s:2,st_path2:3,st_path3:4,st_path3s:5,st_path4:6,st_pain:7,st_pain1:8,st_shoot1:9,st_shoot2:10,st_shoot3:11,st_shoot4:12,st_shoot5:13,st_shoot6:14,st_shoot7:15,st_shoot8:16,st_shoot9:17,st_chase1:18,st_chase1s:19,st_chase2:20,st_chase3:21,st_chase3s:22,st_chase4:23,st_die1:24,st_die2:25,st_die3:26,st_die4:27,st_die5:28,st_die6:29,st_die7:30,st_die8:31,st_die9:32,st_dead:33,st_remove:34});var d=[4,5,6,7,0,1,2,3,0],c=[4,7,6,5,0,1,2,3,0];return{process:o,resetGuards:a,getNewActor:t,spawn:n,spawnDeadGuard:l,spawnPatrol:f,spawnStand:r,spawnBoss:_,spawnGhosts:i,spawnBJVictory:W,stateChange:s}}();