Wolf.PushWall=function(){function e(){a.active=!1,a.tilesMoved=0,a.pointsMoved=0,a.dir=0,a.x=0,a.y=0,a.dx=0,a.dy=0,a.texX=0,a.texY=0}function l(e,l,t,o){var x,i;return a.active?!1:(x=Wolf.Math.dx4dir[o],i=Wolf.Math.dy4dir[o],e.tileMap[l+x][t+i]&(Wolf.SOLID_TILE|Wolf.DOOR_TILE)?!0:(e.tileMap[l][t]&=~Wolf.SECRET_TILE,e.tileMap[l][t]&=~Wolf.WALL_TILE,e.tileMap[l][t]|=Wolf.PUSHWALL_TILE,++e.state.foundSecrets==e.state.totalSecrets?Wolf.Game.notify("You found the last secret!"):Wolf.Game.notify("You found a secret!"),Wolf.Sound.startSound(null,null,1,Wolf.CHAN_AUTO,"sfx/034.wav",1,Wolf.ATTN_STATIC,0),e.tileMap[l+x][t+i]|=Wolf.PUSHWALL_TILE,e.wallTexX[l+x][t+i]=e.wallTexX[l][t],e.wallTexY[l+x][t+i]=e.wallTexY[l][t],a.active=!0,a.tilesMoved=a.pointsMoved=0,a.dir=o,a.x=l,a.y=t,a.dx=x,a.dy=i,a.texX=e.wallTexX[l][t],a.texY=e.wallTexY[l][t],!0))}function t(e,l){a.active&&(a.pointsMoved+=l,a.pointsMoved<128||(a.pointsMoved-=128,a.tilesMoved++,e.tileMap[a.x][a.y]&=~Wolf.PUSHWALL_TILE,a.x+=a.dx,a.y+=a.dy,e.tileMap[a.x+a.dx][a.y+a.dy]&(Wolf.SOLID_TILE|Wolf.DOOR_TILE|Wolf.ACTOR_TILE|Wolf.POWERUP_TILE)||3==a.tilesMoved?(e.tileMap[a.x][a.y]&=~Wolf.PUSHWALL_TILE,e.tileMap[a.x][a.y]|=Wolf.WALL_TILE,e.wallTexX[a.x][a.y]=a.texX,e.wallTexY[a.x][a.y]=a.texY,a.active=!1):(e.tileMap[a.x+a.dx][a.y+a.dy]|=Wolf.PUSHWALL_TILE,e.wallTexX[a.x+a.dx][a.y+a.dy]=a.texX,e.wallTexY[a.x+a.dx][a.y+a.dy]=a.texY)))}function o(){return a}var a={};return e(),{reset:e,process:t,push:l,get:o}}();